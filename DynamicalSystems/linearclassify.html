
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>23. Linear systems &#8212; Mathematics for Natural Sciences 2</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e8e5499552300ddf5d7adccae7cc3b70.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="24. Bifurcation analysis" href="linearize.html" />
    <link rel="prev" title="22. The phase portrait" href="phase_portrait.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mathematics for Natural Sciences 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to NSCI0027
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../VectorCalculus/partialdifferentiation.html">
   1. Multivariable Calculus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VectorCalculus/integrationprelim.html">
   2. Integration Preliminaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VectorCalculus/vectoralgebra.html">
   3. Vectors and Vector Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VectorCalculus/calculusonfields.html">
   4. Vector Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VectorCalculus/divandcurl.html">
   5. Variations of Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VectorCalculus/coordinatesystems.html">
   6. Coordinate Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VectorCalculus/lineintegrals.html">
   7. Line Integrals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VectorCalculus/volumeintegrals.html">
   8. Multidimensional Integrals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VectorCalculus/surfaceintegrals.html">
   9. Surface Integrals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VectorCalculus/vectorcalctheorems.html">
   10. Vector Calculus Theorems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ProofLogic/setsnotation.html">
   11. Set Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ProofLogic/functions.html">
   12. Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ProofLogic/propositionallogic.html">
   13. Propositional Logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ProofLogic/methodsofproof.html">
   14. Techniques of Proof
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../LinearAlgebra/linear_systems_matrices/echelon_form.html">
   15. Linear Systems of Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../LinearAlgebra/linear_systems_matrices/matrices.html">
   16. Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../LinearAlgebra/linear_systems_matrices/linear_maps.html">
   17. Linear Transformations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../LinearAlgebra/linear_systems_matrices/inverses.html">
   18. Inverses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../LinearAlgebra/linear_systems_matrices/determinants.html">
   19. Determinants
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../LinearAlgebra/eigenvectors/notes.html">
   20. Eigenvalues and Eigenvectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../LinearAlgebra/linear_systems_matrices/diagonalisation.html">
   21. Matrix Diagonalisation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="phase_portrait.html">
   22. The phase portrait
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   23. Linear systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linearize.html">
   24. Bifurcation analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="limit_cycles.html">
   25. Limit cycles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="python_examples.html">
   26. Python code
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/DynamicalSystems/linearclassify.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/DynamicalSystems/linearclassify.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/UCLNatSci/Mathematics-for-Natural-Sciences-2/master?urlpath=tree/docs/DynamicalSystems/linearclassify.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#real-distinct-eigenvalues-lambda-1-neq-lambda-2">
   23.1. Real, distinct eigenvalues
   <span class="math notranslate nohighlight">
    \(\lambda_1 \neq \lambda_2\)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unstable-node-lambda-1-lambda-2-0">
     23.1.1. Unstable node:
     <span class="math notranslate nohighlight">
      \(\lambda_1, \lambda_2 &gt;0\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stable-node-lambda-1-lambda-2-0">
     23.1.2. Stable node:
     <span class="math notranslate nohighlight">
      \(\lambda_1, \lambda_2&lt;0\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#saddle-lambda-1-0-lambda-2-0">
     23.1.3. Saddle:
     <span class="math notranslate nohighlight">
      \(\lambda_1&lt;0\)
     </span>
     ,
     <span class="math notranslate nohighlight">
      \(\lambda_2&gt;0\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#real-repeated-eigenvalues-lambda">
   23.2. Real repeated eigenvalues
   <span class="math notranslate nohighlight">
    \(\lambda\)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unstable-inflected-node-lambda-0">
     23.2.1. Unstable inflected node:
     <span class="math notranslate nohighlight">
      \(\lambda&gt;0\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stable-inflected-node-lambda-0">
     23.2.2. Stable inflected node:
     <span class="math notranslate nohighlight">
      \(\lambda&lt;0\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#complex-conjugate-eigenvalues-lambda-mu-pm-i-omega">
   23.3. Complex conjugate eigenvalues
   <span class="math notranslate nohighlight">
    \(\lambda=\mu\pm i\omega\)
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#centre-mu-0">
     23.3.1. Centre:
     <span class="math notranslate nohighlight">
      \(\mu=0\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unstable-spiral-mu-0">
     23.3.2. Unstable spiral:
     <span class="math notranslate nohighlight">
      \(\mu&gt;0\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stable-spiral-mu-0">
     23.3.3. Stable spiral
     <span class="math notranslate nohighlight">
      \(\mu&lt;0\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   23.4. Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#equilibrium-points-in-n-dimensions">
   23.5. Equilibrium points in
   <span class="math notranslate nohighlight">
    \(n\)
   </span>
   dimensions
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="linear-systems">
<h1><span class="section-number">23. </span>Linear systems<a class="headerlink" href="#linear-systems" title="Permalink to this headline">¶</a></h1>
<p>Now, we will start to build up some theory. To do this, we will revert to the simplest general class of 2D problem, which consists of a pair of coupled, linear differential equations. We will consider a system of the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-638476bd-cd62-4937-b93a-51a18b709818">
<span class="eqno">(23.1)<a class="headerlink" href="#equation-638476bd-cd62-4937-b93a-51a18b709818" title="Permalink to this equation">¶</a></span>\[\begin{align}
\dot{x}&amp;=a_{11}x + a_{12}y,\\
\dot{y}&amp;=a_{21}x + a_{22}y.
\end{align}\]</div>
<p>The equation can be written in matrix form as follows:</p>
<div class="amsmath math notranslate nohighlight" id="equation-89f9d8dc-c948-4a5f-a494-854ec10b8d1c">
<span class="eqno">(23.2)<a class="headerlink" href="#equation-89f9d8dc-c948-4a5f-a494-854ec10b8d1c" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\begin{bmatrix}\dot{x}\\\dot{y}\end{bmatrix}=\begin{bmatrix}a_{11} &amp; a_{12}\\a_{21}&amp;a_{22}\end{bmatrix}\begin{bmatrix}x\\y\end{bmatrix}.
\end{equation}\]</div>
<p>Recalling the ansatz for systems of this type, we may take <span class="math notranslate nohighlight">\((x,y)=(x_0 e^{\lambda t},y_0 e^{\lambda t})\)</span>, and by substituting into the ODE we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}a_{11} &amp; a_{12}\\a_{21}&amp;a_{22}\end{bmatrix} \begin{bmatrix}x\\y\end{bmatrix} = \lambda \begin{bmatrix}x\\y\end{bmatrix}.\end{split}\]</div>
<p>This is an eigenvalue problem <span class="math notranslate nohighlight">\(A\underline{x}=\lambda \underline{x}\)</span>, where <span class="math notranslate nohighlight">\(A\)</span> is the coefficient matrix. We may distinguish the character of the phase portrait according to the nature of the eigenvalues.</p>
<p>We will consider some examples below. In each example, the phase portrait will be plotted on the range <span class="math notranslate nohighlight">\(x,y\in[-2,2]\)</span>. We start by making the a meshgrid for this domain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="real-distinct-eigenvalues-lambda-1-neq-lambda-2">
<h2><span class="section-number">23.1. </span>Real, distinct eigenvalues <span class="math notranslate nohighlight">\(\lambda_1 \neq \lambda_2\)</span><a class="headerlink" href="#real-distinct-eigenvalues-lambda-1-neq-lambda-2" title="Permalink to this headline">¶</a></h2>
<p>First we will consider some examples where the eigenvalues are real and distinct. In that case, the general form of the solution can be written as</p>
<div class="math notranslate nohighlight" id="equation-realeigs">
<span class="eqno">(23.3)<a class="headerlink" href="#equation-realeigs" title="Permalink to this equation">¶</a></span>\[\underline{x}=c_1 \underline{v}_1 e^{\lambda_1 t}+c_2 \underline{v}_2 e^{\lambda_2 t}\]</div>
<p>in which <span class="math notranslate nohighlight">\(\underline{v}_1,\underline{v}_2\)</span> are eigenvectors corresponding to the eigenvalues <span class="math notranslate nohighlight">\(\lambda_1,\lambda_2\)</span>, and <span class="math notranslate nohighlight">\(c_0,c_1\)</span> are arbitrary constants, which may be chosen to satisfy any given initial conditions.</p>
<p>Notice that as <span class="math notranslate nohighlight">\(t\rightarrow\infty\)</span> one of the eigensolutions will dominate and so solution trajectories will end up parallel to the eigenvector corresponding to the largest eigenvalue.</p>
<p><strong>Eigenvector directions</strong></p>
<p>According to the relationship <span class="math notranslate nohighlight">\(A\underline{x}=\lambda\underline{x}\)</span>, the vector field at points lying along the eigenvector directions points directly away/towards the equilibrium point at the origin, depending on the sign of the eigenvalue.</p>
<div class="section" id="unstable-node-lambda-1-lambda-2-0">
<span id="unst-nod"></span><h3><span class="section-number">23.1.1. </span>Unstable node: <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2 &gt;0\)</span><a class="headerlink" href="#unstable-node-lambda-1-lambda-2-0" title="Permalink to this headline">¶</a></h3>
<p>Consider the following example system :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot{x} &amp;= 4x+y\\
\dot{y} &amp; =2x+3y
\end{align}\end{split}\]</div>
<p>The eigenvalues and corresponding eigenvectors of the coefficient matrix are given below. The direction <span class="math notranslate nohighlight">\(y=x\)</span> has the largest eigenvalue and solution trajectories will end up parallel to this direction.</p>
<p>All solution trajectories point away from the equilibrium point, which is unstable.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\lambda=5 &amp;: \quad y=x\\
\lambda=2 &amp;: \quad y=-2x
\end{align}\end{split}\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define the vector field values at each point</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">Y</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>

<span class="c1">#----------------------------------</span>
<span class="n">start</span><span class="o">=</span><span class="p">[</span> <span class="c1">#start points of selected field lines</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">]</span>
<span class="c1">#----------------------------------</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_3_0.png" class="align-center" src="../_images/linearclassify_3_0.png" />
</div>
</div>
<div class="exercise admonition" id="DynamicalSystems/linearclassify-exercise-0">
<p class="admonition-title"><span class="caption-number">Exercise 23.1 </span> </p>
<div class="section" id="exercise-content">
<p>Write down the general solution of the given ODE</p>
</div>
</div>
<div class="toggle docutils container">
<p>The general form of the solution is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\underline{x}=c_1e^{5t}\begin{bmatrix}1\\1\end{bmatrix}+c_2e^{2t}\begin{bmatrix}1\\-2\end{bmatrix}
\end{equation*}\]</div>
</div>
</div>
<div class="section" id="stable-node-lambda-1-lambda-2-0">
<h3><span class="section-number">23.1.2. </span>Stable node: <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2&lt;0\)</span><a class="headerlink" href="#stable-node-lambda-1-lambda-2-0" title="Permalink to this headline">¶</a></h3>
<p>Consider the following example system :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot{x} &amp;= -2x+y\\
\dot{y} &amp; =2x-3y
\end{align}\end{split}\]</div>
<p>The eigenvalues and corresponding eigenvectors of the coefficient matrix are given below. The direction <span class="math notranslate nohighlight">\(y=-2x\)</span> has the largest (magnitude) eigenvalue and solution trajectories will be parallel to this direction for large negative <span class="math notranslate nohighlight">\(t\)</span></p>
<p>All solution trajectories point towards the equilibrium point, which is stable.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\lambda=-4 &amp;: \quad y=-2x\\
\lambda=-1 &amp;: \quad y=-x
\end{align}\end{split}\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define the vector field values at each point</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">Y</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>

<span class="c1">#----------------------------------</span>
<span class="n">start</span><span class="o">=</span><span class="p">[</span> <span class="c1">#start points of selected field lines</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.2</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">]</span>
<span class="c1">#----------------------------------</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_5_0.png" class="align-center" src="../_images/linearclassify_5_0.png" />
</div>
</div>
</div>
<div class="section" id="saddle-lambda-1-0-lambda-2-0">
<h3><span class="section-number">23.1.3. </span>Saddle: <span class="math notranslate nohighlight">\(\lambda_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(\lambda_2&gt;0\)</span><a class="headerlink" href="#saddle-lambda-1-0-lambda-2-0" title="Permalink to this headline">¶</a></h3>
<p>In the example below there is one positive eigenvalue and one negative. The solution trajectory approaches one of the trajectories as <span class="math notranslate nohighlight">\(t\rightarrow-\infty\)</span> and the other as <span class="math notranslate nohighlight">\(t\rightarrow +\infty\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot{x} &amp;= x+3y\\
\dot{y} &amp; =2x+2y
\end{align}\end{split}\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define the vector field values at each point</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">Y</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">Y</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>

<span class="c1">#----------------------------------</span>
<span class="n">start</span><span class="o">=</span><span class="p">[</span> <span class="c1">#start points of selected field lines</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">],[</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mf">0.01</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mf">0.2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="mf">0.01</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="mf">0.01</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="mf">0.2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mf">0.01</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mf">0.2</span><span class="p">]</span>
    <span class="p">]</span>
<span class="c1">#----------------------------------</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_7_0.png" class="align-center" src="../_images/linearclassify_7_0.png" />
</div>
</div>
<div class="exercise admonition" id="DynamicalSystems/linearclassify-exercise-1">
<p class="admonition-title"><span class="caption-number">Exercise 23.2 </span> </p>
<div class="section" id="exercise-content">
<p>Calculate the eigenvalues and corresponding eigenvectors for this problem.</p>
</div>
</div>
<div class="toggle docutils container">
<p>Eigenvalues and corresponding eigenvectors:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\lambda=-1 &amp;: \quad y=-\frac{2}{3}x\\
\lambda=4 &amp;: \quad y=x
\end{align}\end{split}\]</div>
</div>
</div>
</div>
<div class="section" id="real-repeated-eigenvalues-lambda">
<h2><span class="section-number">23.2. </span>Real repeated eigenvalues <span class="math notranslate nohighlight">\(\lambda\)</span><a class="headerlink" href="#real-repeated-eigenvalues-lambda" title="Permalink to this headline">¶</a></h2>
<p>If the eigenvalue problem has repeated roots <span class="math notranslate nohighlight">\(\lambda\)</span> corresponding to eigenvector <span class="math notranslate nohighlight">\(\underline{v}_1\)</span> then we need to find a second linearly independent solution. We may try the following ansatz</p>
<div class="amsmath math notranslate nohighlight" id="equation-198406a1-2b13-4fdf-a1dc-41f2bcb3c403">
<span class="eqno">(23.4)<a class="headerlink" href="#equation-198406a1-2b13-4fdf-a1dc-41f2bcb3c403" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\underline{x}=e^{\lambda t}(t\underline{v}_1+\underline{v}_2).
\end{equation}\]</div>
<p>Substituting into the problem <span class="math notranslate nohighlight">\(\underline{x}^{\prime}=A\underline{x}\)</span> we find this is a solution if</p>
<div class="amsmath math notranslate nohighlight" id="equation-67d5e0fa-c227-4d6d-972c-465d7a030c58">
<span class="eqno">(23.5)<a class="headerlink" href="#equation-67d5e0fa-c227-4d6d-972c-465d7a030c58" title="Permalink to this equation">¶</a></span>\[\begin{equation}
(A-\lambda I)\underline{v}_2=\underline{v}_1
\end{equation}\]</div>
<p>Thus, the general solution is of the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-45077be6-3da5-4a17-8a73-1dc124e85510">
<span class="eqno">(23.6)<a class="headerlink" href="#equation-45077be6-3da5-4a17-8a73-1dc124e85510" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\underline{x}=c_1\underline{v}_1e^{\lambda t}+c_2e^{\lambda t}(t\underline{v}_1+\underline{v}_2)
\end{equation}\]</div>
<p>For large <span class="math notranslate nohighlight">\(t\)</span> the term <span class="math notranslate nohighlight">\(t\underline{v}_1e^{\lambda t}\)</span> dominates and the solution ends up parallel to the eigenvector <span class="math notranslate nohighlight">\(\underline{v}_1\)</span></p>
<div class="section" id="unstable-inflected-node-lambda-0">
<h3><span class="section-number">23.2.1. </span>Unstable inflected node: <span class="math notranslate nohighlight">\(\lambda&gt;0\)</span><a class="headerlink" href="#unstable-inflected-node-lambda-0" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot{x} &amp;= 3x+y\\
\dot{y} &amp; =-x+y
\end{align}\end{split}\]</div>
<p>Eigenvalues and corresponding eigenvectors:</p>
<div class="math notranslate nohighlight">
\[\lambda=2 : \quad y=-x\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define the vector field values at each point</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">,</span><span class="o">-</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>

<span class="c1">#----------------------------------</span>
<span class="n">start</span><span class="o">=</span><span class="p">[</span> <span class="c1">#start points of selected field lines</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">]]</span>
<span class="c1">#----------------------------------</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_9_0.png" class="align-center" src="../_images/linearclassify_9_0.png" />
</div>
</div>
<div class="exercise admonition" id="DynamicalSystems/linearclassify-exercise-2">
<p class="admonition-title"><span class="caption-number">Exercise 23.3 </span> </p>
<div class="section" id="exercise-content">
<p>Find the general solution of the given ODE</p>
</div>
</div>
<div class="toggle docutils container">
<p>Solve <span class="math notranslate nohighlight">\((A-\lambda I)\underline{v}_2=\underline{v}_1\)</span>, where <span class="math notranslate nohighlight">\(\underline{v}_1=\begin{bmatrix}1\\-1\end{bmatrix}\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\begin{bmatrix}1&amp;1\\-1&amp;-1\end{bmatrix}\begin{bmatrix}x\\y\end{bmatrix}=\begin{bmatrix}1\\-1\end{bmatrix} \qquad\Rightarrow \quad x+y=1
\end{equation*}\]</div>
<p>A suitable choice is <span class="math notranslate nohighlight">\(\underline{v}_2=\begin{bmatrix}0\\1\end{bmatrix}\)</span></p>
<p>The general form of the solution is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\underline{x}=c_1e^{2t}\begin{bmatrix}1\\-1\end{bmatrix}+c_2e^{2t}\left(t\begin{bmatrix}1\\-1\end{bmatrix}+\begin{bmatrix}0\\1\end{bmatrix}\right)
\end{equation*}\]</div>
</div>
</div>
<div class="section" id="stable-inflected-node-lambda-0">
<h3><span class="section-number">23.2.2. </span>Stable inflected node: <span class="math notranslate nohighlight">\(\lambda&lt;0\)</span><a class="headerlink" href="#stable-inflected-node-lambda-0" title="Permalink to this headline">¶</a></h3>
<p>The following problem is an example of a stable inflected node. See if you can sketch it.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot{x} &amp;= -3x+y\\
\dot{y} &amp; =-x-y
\end{align}\end{split}\]</div>
<div class="toggle docutils container">
<p><strong>Solution</strong></p>
<p>Eigenvalues and corresponding eigenvectors:</p>
<div class="math notranslate nohighlight">
\[\lambda=-2 : \quad y=x\]</div>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_11_0.png" src="../_images/linearclassify_11_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="complex-conjugate-eigenvalues-lambda-mu-pm-i-omega">
<h2><span class="section-number">23.3. </span>Complex conjugate eigenvalues <span class="math notranslate nohighlight">\(\lambda=\mu\pm i\omega\)</span><a class="headerlink" href="#complex-conjugate-eigenvalues-lambda-mu-pm-i-omega" title="Permalink to this headline">¶</a></h2>
<p>In the case of complex conjugate eigenvalues the eigenvectors will also be complex, of the form <span class="math notranslate nohighlight">\(\underline{v}=\underline{v}_r\pm i\underline{v}_i\)</span>. Expanding out the complex terms in the general solution <a class="reference internal" href="#equation-realeigs">(23.3)</a> using Euler’s identity gives a solution of the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-59621b02-4cf8-4de9-a5dc-878d41d6fcf6">
<span class="eqno">(23.7)<a class="headerlink" href="#equation-59621b02-4cf8-4de9-a5dc-878d41d6fcf6" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\underline{x}=c_1 \underline{x}_1+c_2\underline{x}_2
\end{equation}\]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\underline{x}_1&amp;= e^{\mu t}(\underline{v}_r \cos(\omega t)-\underline{v}_i \sin(\omega t))\\
\underline{x}_2&amp;= e^{\mu t}(\underline{v}_r \sin(\omega t)+\underline{v}_i \cos(\omega t))\\
\end{align*}\]</div>
<p>It can be seen that the solutions for <span class="math notranslate nohighlight">\((x,y)\)</span> demonstrate oscillating behaviour with growing or decay amplitude.</p>
<p>You may also recall earlier from earlier work on eigenvalues and eigenvectors that real eigenvectors correspond to a stretch transform and that complex eigenvalues correspond to a rotation transform. In the phase plane, the change vectors <span class="math notranslate nohighlight">\(A\underline{x}\)</span> are rotational.</p>
<div class="section" id="centre-mu-0">
<h3><span class="section-number">23.3.1. </span>Centre: <span class="math notranslate nohighlight">\(\mu=0\)</span><a class="headerlink" href="#centre-mu-0" title="Permalink to this headline">¶</a></h3>
<p>In the case where the eigenvalues are purely imaginary, the solution oscillates without change of amplitude. The equilibrium point is <em>neutrally stable</em>. If we perturb the system away from its equilibrium point it will not return to equilibrium, but neither will it move away from it. The solution will remain on a trajectory encircling the equilibrium point.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot{x} &amp;= y\\
\dot{y} &amp; =-4x
\end{align}\end{split}\]</div>
<p>Eigenvalues : <span class="math notranslate nohighlight">\(=\pm 2i\)</span></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define the vector field values at each point</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">X</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>

<span class="c1">#----------------------------------</span>
<span class="n">start</span><span class="o">=</span><span class="p">[</span> <span class="c1">#start points of selected field lines</span>
    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],[</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">]]</span>
<span class="c1">#----------------------------------</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_13_0.png" class="align-center" src="../_images/linearclassify_13_0.png" />
</div>
</div>
</div>
<div class="section" id="unstable-spiral-mu-0">
<h3><span class="section-number">23.3.2. </span>Unstable spiral: <span class="math notranslate nohighlight">\(\mu&gt;0\)</span><a class="headerlink" href="#unstable-spiral-mu-0" title="Permalink to this headline">¶</a></h3>
<p>The following system is an example case where the equilibrium point is an unstable spiral. The eigenvalues are complex conjugate, so the solutions oscillate. Since the real part of the eigenvalue is positive, the amplitude of the oscillations grows ever-larger. An example of a system demonstrating this type of behaviour would be a pendulum with “negative friction”.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot{x} &amp;= x-3y\\
\dot{y} &amp; =3x+y
\end{align}\end{split}\]</div>
<p>Eigenvalues : <span class="math notranslate nohighlight">\(\lambda=1\pm 3i\)</span></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define the vector field values at each point</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">Y</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>

<span class="c1">#----------------------------------</span>
<span class="n">start</span><span class="o">=</span><span class="p">[</span> <span class="c1">#start points of selected field lines</span>
    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mf">1.5</span><span class="p">]]</span>
<span class="c1">#----------------------------------</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_15_0.png" class="align-center" src="../_images/linearclassify_15_0.png" />
</div>
</div>
</div>
<div class="section" id="stable-spiral-mu-0">
<h3><span class="section-number">23.3.3. </span>Stable spiral <span class="math notranslate nohighlight">\(\mu&lt;0\)</span><a class="headerlink" href="#stable-spiral-mu-0" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\dot{x} &amp;= x-3y\\
\dot{y} &amp; =5x-2y
\end{align}\end{split}\]</div>
<div class="exercise admonition" id="DynamicalSystems/linearclassify-exercise-3">
<p class="admonition-title"><span class="caption-number">Exercise 23.4 </span> </p>
<div class="section" id="exercise-content">
<p>Find the eigenvalues of this system and have a go at plotting the phase portrait by hand. Verify your answer by producing a computer plot of the phase portrait. You could do this either by showing the vector field with a few streamlines, or by plotting the solution trajectory for suitable initial conditions</p>
<p><em>You could also have a try at finding the general form of the solution, although we do not need it to construct the phase portrait.</em></p>
</div>
</div>
<div class="toggle docutils container">
<p><strong>Solution:</strong></p>
<p>Eigenvalues : <span class="math notranslate nohighlight">\(\lambda=-\frac{1}{2}(1\pm \sqrt{51}i)\)</span></p>
<p>In the code below the solution phase portrait is constructed from the vector field. Have a try at plotting solution trajectories using <code class="docutils literal notranslate"><span class="pre">odesolve</span></code>.</p>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_17_0.png" src="../_images/linearclassify_17_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="summary">
<h2><span class="section-number">23.4. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>In two dimensions we can encounter a range of equilibrium types:</p>
<ul class="simple">
<li><p>Nodes and saddle points (stable or unstable) are a superposition of 1d equilibrium types</p></li>
<li><p>Spirals and centres are an irreducibly 2d type of equilibrium, because they involve rotation</p></li>
</ul>
<p>The derivations here were done for linear systems, but in the next chapter we will see that these types of equilibrium point can also be encountered in nonlinear systems.</p>
<div class="exercise admonition" id="ex-235">
<p class="admonition-title"><span class="caption-number">Exercise 23.5 </span> </p>
<div class="section" id="exercise-content">
<p>The Rayleigh model is given by</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\dot{x}&amp;=v\\
\dot{v}&amp;=-x-c(v^3-v)
\end{align*}\]</div>
<p>Produce a phase portrait for this system for some different values of the constant <span class="math notranslate nohighlight">\(c\)</span>. Try values that are negative, positive and zero. How does the character of the equilibrium point change?</p>
</div>
</div>
<div class="toggle docutils container">
<p><strong>Solution:</strong></p>
<p>There is an equilibrium point at <span class="math notranslate nohighlight">\((0,0)\)</span>. Some illustrative phase portraits are shown below.</p>
<ul class="simple">
<li><p>For <span class="math notranslate nohighlight">\(c&lt;-2\)</span> it is a stable node</p></li>
<li><p>For <span class="math notranslate nohighlight">\(-2&lt;c&lt;0\)</span> it is a stable spiral</p></li>
<li><p>For <span class="math notranslate nohighlight">\(0&lt;c&lt;2\)</span> it is an unstable spiral</p></li>
<li><p>For <span class="math notranslate nohighlight">\(c&gt;2\)</span> it is an unstable node</p></li>
</ul>
<p>The critical values where the equilibrium point changes type are:</p>
<ul class="simple">
<li><p>When <span class="math notranslate nohighlight">\(c=-2\)</span> it is a stable inflected node</p></li>
<li><p>When <span class="math notranslate nohighlight">\(c=0\)</span> it is a centre</p></li>
<li><p>When <span class="math notranslate nohighlight">\(c=2\)</span> it is an unstable inflected node</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="p">[</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="n">c</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="o">-</span><span class="n">X</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">Y</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="n">Y</span><span class="p">))</span>
<span class="n">start</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;c=-1&#39;</span><span class="p">)</span>

<span class="n">c</span><span class="o">=</span><span class="mi">0</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="o">-</span><span class="n">X</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">Y</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="n">Y</span><span class="p">))</span>
<span class="n">start</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;c=0&#39;</span><span class="p">)</span>

<span class="n">c</span><span class="o">=</span><span class="mi">1</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="o">-</span><span class="n">X</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">Y</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="n">Y</span><span class="p">))</span>
<span class="n">start</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">maxlength</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;c=1&#39;</span><span class="p">)</span>


<span class="n">c</span><span class="o">=</span><span class="mf">2.1</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="o">-</span><span class="n">X</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">Y</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="n">Y</span><span class="p">))</span>
<span class="n">start</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">maxlength</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;c=3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_19_0.png" src="../_images/linearclassify_19_0.png" />
</div>
<p>Notice also that there is a limit cycle, which is unstable for <span class="math notranslate nohighlight">\(c&lt;0\)</span> and stable for <span class="math notranslate nohighlight">\(c&gt;0\)</span>.</p>
</div>
</div>
<div class="section" id="equilibrium-points-in-n-dimensions">
<h2><span class="section-number">23.5. </span>Equilibrium points in <span class="math notranslate nohighlight">\(n\)</span> dimensions<a class="headerlink" href="#equilibrium-points-in-n-dimensions" title="Permalink to this headline">¶</a></h2>
<p>Equilibrium points in <span class="math notranslate nohighlight">\(n\)</span> dimensions are composed of the 1d and 2d  types that we have considered - i.e. nodes,spirals and centres. For example, consider the following system, which has an equilibrium point at the origin</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\dot{x}&amp;=3x-9y+8z\\
\dot{y}&amp;=7x-4y-4z\\
\dot{z}&amp;=-2x+4y+z
\end{align*}\end{split}\]</div>
<p>The system has one real eigenvalue, which is negative and two that are positive</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">la</span>

<span class="n">M</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">],[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">la</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.08016923561500475+10.296566482037464j)
(0.08016923561500475-10.296566482037464j)
(-0.16033847123000597+0j)
</pre></div>
</div>
</div>
</div>
<p>Hence, the equilibrium point combines the 2d behaviour of a stable centre with the 1d behaviour of a stable node.</p>
<p>Here, plotting the 2d phase portrait at a constant value of <span class="math notranslate nohighlight">\(z\)</span> shows the stable spiral</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

<span class="c1">#define the vector field values at each point</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">W</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">X</span><span class="o">-</span><span class="mi">9</span><span class="o">*</span><span class="n">Y</span><span class="o">+</span><span class="mi">8</span><span class="o">*</span><span class="n">Z</span><span class="p">,</span><span class="mi">7</span><span class="o">*</span><span class="n">X</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">Y</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">Z</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">Y</span><span class="o">+</span><span class="n">Z</span><span class="p">)</span>

<span class="n">start</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,:,</span><span class="mi">5</span><span class="p">],</span><span class="n">Y</span><span class="p">[:,:,</span><span class="mi">5</span><span class="p">],</span><span class="n">U</span><span class="p">[:,:,</span><span class="mi">5</span><span class="p">],</span><span class="n">V</span><span class="p">[:,:,</span><span class="mi">5</span><span class="p">],</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_23_0.png" class="align-center" src="../_images/linearclassify_23_0.png" />
</div>
</div>
<p>Plotting one of the solution trajectories can illustrate the nature of the equilibrium point in three dimensions:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">v</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">mysys</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
  <span class="n">dXdt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">X</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">dXdt</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">mysys</span><span class="p">,</span><span class="n">init</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linearclassify_25_0.png" class="align-center" src="../_images/linearclassify_25_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./DynamicalSystems"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="phase_portrait.html" title="previous page"><span class="section-number">22. </span>The phase portrait</a>
    <a class='right-next' id="next-link" href="linearize.html" title="next page"><span class="section-number">24. </span>Bifurcation analysis</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Natural Sciences<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multivariable Calculus &#8212; Mathematics for Natural Sciences 2</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="" href="integrationprelim.html" />
    <link rel="prev" title="Welcome to NSCI0027" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mathematics for Natural Sciences 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to NSCI0027
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Multivariable Calculus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="integrationprelim.html">
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coordinatesystems.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="surfaceintegrals.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="volumeintegrals.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vectorcalctheorems.html">
   Markdown Files
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/partialdifferentiation.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/UCLNatSci/Mathematics-for-Natural-Sciences-2"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/UCLNatSci/Mathematics-for-Natural-Sciences-2/issues/new?title=Issue%20on%20page%20%2Fpartialdifferentiation.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-plot-of-the-function-f-x-y-x-3-y-3-2xy-2">
   A plot of the function
   <span class="math notranslate nohighlight">
    \(f(x,\, y) = x^3 - y^3 - 2xy + 2\)
   </span>
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="multivariable-calculus">
<h1>Multivariable Calculus<a class="headerlink" href="#multivariable-calculus" title="Permalink to this headline">¶</a></h1>
<p>The plot shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">surf1</span></code> is the function <span class="math notranslate nohighlight">\(f(x,\, y)= x^3 - y^3 - 2xy + 2\)</span>, on which curves marked on the surface for lines of constant <span class="math notranslate nohighlight">\(x,\,y\)</span>.  We
can consider the rate of change of the function, both:</p>
<ul class="simple">
<li><p>along a curve parallel to the <span class="math notranslate nohighlight">\(x\)</span>-axis, by holding <span class="math notranslate nohighlight">\(y\)</span> constant and differentiating with respect to <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>along a curve parallel to the <span class="math notranslate nohighlight">\(y\)</span>-axis, by holding <span class="math notranslate nohighlight">\(x\)</span> constant and differentiating with respect to <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
</ul>
<div class="section" id="a-plot-of-the-function-f-x-y-x-3-y-3-2xy-2">
<h2>A plot of the function <span class="math notranslate nohighlight">\(f(x,\, y) = x^3 - y^3 - 2xy + 2\)</span><a class="headerlink" href="#a-plot-of-the-function-f-x-y-x-3-y-3-2xy-2" title="Permalink to this headline">¶</a></h2>
</div>
<div class="figure align-default">
<img alt="../figures/surf1.png" src="../figures/surf1.png" />
</div>
<p>For instance, along the line $<span class="math notranslate nohighlight">\(x=1\)</span><span class="math notranslate nohighlight">\(, we have \)</span><span class="math notranslate nohighlight">\(f(1,y)=-y^3-2 y+3\)</span><span class="math notranslate nohighlight">\(. We can differentiate this function with respect to \)</span><span class="math notranslate nohighlight">\(y\)</span><span class="math notranslate nohighlight">\( to obtain the rate of change of \)</span><span class="math notranslate nohighlight">\(f(x,y)\)</span><span class="math notranslate nohighlight">\( along the curve. The result is called the &quot;partial&quot; derivative of \)</span><span class="math notranslate nohighlight">\(f\)</span><span class="math notranslate nohighlight">\( with respect to \)</span><span class="math notranslate nohighlight">\(y\)</span><span class="math notranslate nohighlight">\(. It is &quot;partial&quot; because we consider only variations in one of the two variables. We write \)</span><span class="math notranslate nohighlight">\(\displaystyle\frac{\partial f(1,y)}{\partial y}=-3y^2-2\)</span>$.</p>
<p>More generally, for this function</p>
<p>\begin{align}\frac{\partial f(x,y)}{\partial y}&amp;=-3y^2-2x \quad &amp;\text{(holding <span class="math notranslate nohighlight">\(x\)</span> constant and differentiating with respect to <span class="math notranslate nohighlight">\(y\)</span>)}\frac{\partial f(x,y)}{\partial x}&amp;=3x^2-2y \quad &amp;\text{(holding <span class="math notranslate nohighlight">\(y\)</span> constant and differentiating with respect to <span class="math notranslate nohighlight">\(x\)</span>)}\end{align}</p>
<p>Note the different notation $<span class="math notranslate nohighlight">\((x,y)\)</span><span class="math notranslate nohighlight">\(. The results show the local rate of change parallel to each axis at a point \)</span><span class="math notranslate nohighlight">\((x,y)\)</span>$.</p>
<p>Example 1</p>
<p>Calculate all the first partial derivatives $<span class="math notranslate nohighlight">\(\frac{\partial}{\partial x},\)</span><span class="math notranslate nohighlight">\( \)</span><span class="math notranslate nohighlight">\(\frac{\partial }{\partial y}\)</span>$ for the following functions:</p>
<p>(a) $<span class="math notranslate nohighlight">\(f(x,y) = 3x^3 y^2 +2 y\)</span>$</p>
<p>(b) $<span class="math notranslate nohighlight">\(f(x,y) = x^2 \ln(3x+y)\)</span>$</p>
<p>(c) $<span class="math notranslate nohighlight">\(z(x,y) = \ln(x+y^2\sin(x))\)</span>$</p>
<p>Solutions</p>
<p>(a) $<span class="math notranslate nohighlight">\(\displaystyle\frac{\partial f}{\partial x}=9x^2 y^2, \quad \frac{\partial f}{\partial y}=6x^3 y+2\)</span>$.</p>
<p>(b) $<span class="math notranslate nohighlight">\(\displaystyle\frac{\partial f}{\partial x}=2x\ln(3x+y) + \frac{3x^2}{3x+y}, \quad \frac{\partial f}{\partial y}=\frac{x^2}{3x+y}\)</span>$</p>
<p>(c) $<span class="math notranslate nohighlight">\(\displaystyle\frac{\partial z}{\partial x}=\frac{1+y^2\cos(x)}{x+y^2\sin(x)}, \quad \frac{\partial z}{\partial y}=\frac{2y\sin(x)}{x+y^2\sin(x)}\)</span>$</p>
<p>Second partial derivatives
The second partial derivatives with respect to $<span class="math notranslate nohighlight">\(x\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(y\)</span>$ are denoted as follows:</p>
<p>\begin{equation}\frac{\partial^2 f}{\partial x^2}=\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial x}\right), \quad \frac{\partial^2 f}{\partial y}\left(\frac{\partial f}{\partial y}\right)\end{equation}</p>
<p>The notation is also extended to mixed second partial derivatives:</p>
<p>\begin{equation}\frac{\partial^2 f}{\partial y \partial x}=\frac{\partial}{\partial y}\left(\frac{\partial f}{\partial x}\right), \quad \frac{\partial^2 f}{\partial x \partial y}=\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial y}\right).\end{equation}</p>
<p>Notice that we work from the inside out, as with function composition and matrix multiplication.</p>
<p>Example:</p>
<p>Calculate all second partial derivatives of the function $<span class="math notranslate nohighlight">\(f(x,y)=3x^3y^2+2y\)</span>$</p>
<p>Solution</p>
<p>\begin{equation}\frac{\partial f}{\partial x}=9x^2y^2, \quad \frac{\partial f}{\partial y}=6x^3y+2,\quad \frac{\partial^2 f}{\partial x^2}=18x y^2,\quad \frac{\partial^2 f}{\partial y^2}=6x^3, \quad \frac{\partial^2 f}{\partial y\partial x}=18x^2y, \quad \frac{\partial^2 f}{\partial x\partial y}=18x^2 y\end{equation}</p>
<p>Notice that $<span class="math notranslate nohighlight">\(\frac{\partial^2 f}{\partial x\partial y}=\frac{\partial^2 f}{\partial y \partial}\)</span><span class="math notranslate nohighlight">\(. This result is general, provided that \)</span><span class="math notranslate nohighlight">\(f\)</span>$ is continuous and differentiable. The proof of this result (called Schwarz’s theorem) is quite involved and is beyond the scope of this course. It relies on showing that the following results are equivalent (provided the partial limits exist and are finite):</p>
<p>\begin{align} \frac{\partial^2 f}{\partial x\partial y}=\lim_{\Delta x\rightarrow 0}\biggr[\frac{\frac{\partial f(x+\Delta x,y)}{\partial y}-\frac{\partial f(x,y)}{\partial y}}{\Delta x}\biggr] &amp;=\lim_{\Delta x \rightarrow 0}\biggr[\frac{\displaystyle\lim_{\Delta y\rightarrow 0}\left[\frac{f(x+\Delta x,y+\Delta y)-f(x+\Delta x,y)}{\Delta y}\right]-\lim_{\Delta y\rightarrow 0}\left[\frac{f(x,y+\Delta y)-f(x,y)}{\Delta y}\right]}{\Delta x}\biggr]\&amp;=\lim_{\Delta x\rightarrow 0}\lim_{\Delta y\rightarrow 0}\left[\frac{f(x+\Delta x,y+\Delta y)-f(c+\Delta x,y)-f(x,y+\Delta y)+f(x,y)}{\Delta x\Delta y}\right]\end{align}</p>
<p>\begin{align} \frac{\partial^2 f}{\partial y\partial x}=\lim_{\Delta y\rightarrow 0}\biggr[\frac{\frac{\partial f(x,y+\Delta y)}{\partial y}-\frac{\partial f(x,y)}{\partial y}}{\Delta y}\biggr] &amp;=\lim_{\Delta y \rightarrow 0}\biggr[\frac{\displaystyle\lim_{\Delta x\rightarrow 0}\left[\frac{f(x+\Delta x,y+\Delta y)-f(x,y+\Delta y)}{\Delta x}\right]-\lim_{\Delta y\rightarrow 0}\left[\frac{f(x+\Delta x,y)-f(x,y)}{\Delta x}\right]}{\Delta x}\biggr]\&amp;=\lim_{\Delta y\rightarrow 0}\lim_{\Delta x\rightarrow 0}\left[\frac{f(x+\Delta x,y+\Delta y)-f(c+\Delta x,y)-f(x,y+\Delta y)+f(x,y)}{\Delta x\Delta y}\right]\end{align}</p>
<p>Interchanging the order of limits is not always possible, although it is valid for “well-behaved” functions. It is possible to show that the assumptions of continuity and differentiability guarantee that the order of the limits can be interchanged.</p>
<p>A common mistake
To calculate $<span class="math notranslate nohighlight">\(\frac{\partial^2}{\partial y\partial x}(x^2 y^3+x+y)\)</span><span class="math notranslate nohighlight">\( at the point \)</span><span class="math notranslate nohighlight">\((1,1)\)</span>$…</p>
<p>Put $<span class="math notranslate nohighlight">\(y=1\)</span><span class="math notranslate nohighlight">\( and differentiate with respect to \)</span><span class="math notranslate nohighlight">\(x\)</span><span class="math notranslate nohighlight">\( to obtain \)</span><span class="math notranslate nohighlight">\(\frac{\partial}{\partial x}(x^2+x+1)=2x\)</span><span class="math notranslate nohighlight">\(       \)</span><span class="math notranslate nohighlight">\(\leftarrow\)</span>$ This step is incorrect!</p>
<p>Put $<span class="math notranslate nohighlight">\(x=1\)</span><span class="math notranslate nohighlight">\( and differentiate with respect to \)</span><span class="math notranslate nohighlight">\(y\)</span><span class="math notranslate nohighlight">\( to obtain \)</span><span class="math notranslate nohighlight">\(\frac{\partial}{\partial y}(2)=0\)</span>$.</p>
<p>The result is wrong, because we took $<span class="math notranslate nohighlight">\(y=1\)</span><span class="math notranslate nohighlight">\( before differentiating with respect to \)</span><span class="math notranslate nohighlight">\(y\)</span>$. To avoid mistakes of this nature, we should always perform differentiation first and only substitute in the values in the very last step. The correct result is</p>
<div class="math notranslate nohighlight">
\[\biggr[\frac{\partial^2}{\partial y\partial x}\left(x^2 y^3 +x+y\right)\biggr]_{(1,1)} = \biggr[\frac{\partial }{\partial y}(2xy^3+1)\biggr]_{(1,1)} = \biggr[6xy^2\biggr]_{(1,1)} = 6\]</div>
<p>Notation:
Partial derivatives are commonly denoted using subscript notation:</p>
<div class="math notranslate nohighlight">
\[f_x=\frac{\partial f}{\partial x}, \quad f_y=\frac{\partial f}{\partial y}, \quad f_{xx}=\frac{\partial^2 f}{\partial x^2}\quad f_{yy}=\frac{\partial^2 f}{\partial y^2}\]</div>
<p>For mixed derivatives the order or subscripts is from left to right:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}f_{xy} = (f_x)_y = \frac{\partial^2 f}{\partial y \partial x}, \quad f_{yx}=(f_y)_x = \frac{\partial^2 f}{\partial x \partial y}$$.\\You will likely come across yet more alternative notations in the literature. For instance, the notation $$D_x=\frac{\partial}{\partial x}$$ is also common.\\Example 2\\\begin{split}The Hessian matrix for a function $$f(x,y)$$ is the (2x2) matrix $$H =\left(\begin{matrix}f_{xx}&amp; f_{x y}\\f_{y x}&amp;f_{yy}\end{matrix}\right)$$.\end{split}\\Calculate the determinant of the Hessian matrix for the function $$f(x,y) = x^3 - y^3 -2xy+2$$.\\Solution\\We have $$f_x = 3x^2-2y, \quad f_y = -3y^2 - 2x\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[f_{xx}=6x, \quad f_{yy}=-6y, \quad f_{xy}=f_{yx}=-2\]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}H=f_{xx}f_{yy} - f_{xy}f_{yx} = -36xy-4$$.\\The Hessian matrix is useful for classifying stationary points.\\Multi-variate chain rule
We now consider a function $$f(x,y)$$ subjected to small variations in both $$x$$ and $$y$$ as shown in the figure below\\multivariate chain rule illustration
Figure 2\\$$f(x+\Delta x, y+\Delta y)$$ in two steps.\\Loosely speaking, the total change in the function $$f$$ is the sum of changes due to each variable:\\\begin{equation}\Delta f = \frac{\partial f}{\partial x}\Delta x + \frac{\partial f}{\partial y}\Delta y\end{equation}\\If we now suppose that $$x=x(u,v)$$ and $$y=y(u,v)$$ then we may similarly write $$\Delta x$$ and $$\Delta y$$ as the sum of changes due to variables $$u$$ and $$v$$:\\\begin{equation}\Delta f = \frac{\partial f}{\partial x}\left[\frac{\partial x}{\partial u}\Delta u +\frac{\partial x}{\partial v}\Delta v\right] + \frac{\partial f}{\partial y}\left[\frac{\partial y}{\partial u}\Delta u +\frac{\partial y}{\partial v}\Delta v\right]\end{equation}\\Holding $$v$$ constant in this expression ($$\Delta v=0$$) gives \\\begin{equation}\frac{\Delta f}{\Delta u}=\frac{\partial f}{\partial x}\frac{\partial x}{\partial u}+\frac{\partial f}{\partial y}\frac{\partial y}{\partial u}\end{equation}\\Holding $$u$$ constant in this expression ($$\Delta u=0$$) gives \\\begin{equation}\frac{\Delta f}{\Delta v}=\frac{\partial f}{\partial x}\frac{\partial x}{\partial v}+\frac{\partial f}{\partial y}\frac{\partial y}{\partial v}\end{equation} \\This was a somewhat &quot;hand-waving&quot; argument, but the results are valid in the limit $$\Delta u\rightarrow 0$$, $$\Delta v\rightarrow 0$$ and can be proved using the limit definition of the derivative. We obtain the multi-variate chain rule, written in the box below:\\The multivariate chain rule\\If $$f=f(x,y)$$ where $$x=x(u,v)$$ and $$y=y(u,v)$$ then\\\begin{split}\begin{align}\frac{\partial f}{\partial u}&amp;=\frac{\partial f}{\partial x}\frac{\partial x}{\partial u}+\frac{\partial f}{\partial y}\frac{\partial y}{\partial u}\\\frac{\partial f}{\partial v}&amp;=\frac{\partial f}{\partial x}\frac{\partial x}{\partial v}+\frac{\partial f}{\partial y}\frac{\partial y}{\partial v}\end{align}\end{split}\\Student's first encountering this rule often think that it &quot;can't be right&quot;, because replacing the partial derivatives with differences gives\\$$\Delta f = \frac{\Delta f}{\Delta x}\Delta x + \frac{\Delta f}{\Delta y}\Delta y,\end{aligned}\end{align} \]</div>
<p>which suggests the result $<span class="math notranslate nohighlight">\(\Delta f = 2\Delta f\)</span><span class="math notranslate nohighlight">\(. However, this misunderstanding comes from ambiguity in writing \)</span><span class="math notranslate nohighlight">\(\Delta f\)</span><span class="math notranslate nohighlight">\(. On the left-hand side it means changes in \)</span><span class="math notranslate nohighlight">\(f\)</span><span class="math notranslate nohighlight">\( dues to variations in both \)</span><span class="math notranslate nohighlight">\(x\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(y\)</span><span class="math notranslate nohighlight">\(, whilst in \)</span><span class="math notranslate nohighlight">\(f_x\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(f_y\)</span>$ the changes are due to only one of these variables whilst the other is held constant. Written formally,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\displaystyle \frac{\partial f}{\partial u} = \lim_{\Delta u\rightarrow 0}\frac{f(x(u+\Delta u,v),y(u+\Delta u,v))-f(x(u,v),y(u,v))}{\Delta u}$$,\\$$\displaystyle\frac{\partial f}{\partial x} = \lim_{\Delta x\rightarrow 0}\frac{f(x+\Delta x,y)-f(x,v)}{\Delta x}=\lim_{\Delta u\rightarrow 0}\frac{f(x(u+\Delta u,v),y(u,v))-f(x(u,v),y(u,v))}{\Delta u}\end{aligned}\end{align} \]</div>
<p>It is dangerous to treat partial derivatives as fractions!</p>
<p>Dependency trees
The multivariate chain rule can be illustrated as a dependency tree. For the first and second derivatives of $<span class="math notranslate nohighlight">\(f(x,y)\)</span><span class="math notranslate nohighlight">\( where \)</span><span class="math notranslate nohighlight">\(x=x(u,v)\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(y=y(u,v)\)</span>$:</p>
<p>dependency tree for first derivatives</p>
<p>For instance, if we follow the dependency routes involving $<span class="math notranslate nohighlight">\(u\)</span><span class="math notranslate nohighlight">\(, we get \)</span><span class="math notranslate nohighlight">\(f_u = f_x x_u + f_y y_u\)</span>$.</p>
<p>We can do the same thing for the second derivatives (a repeat application of the chain rule):</p>
<p>dependency tree for second derivatives</p>
<p>Example 3:</p>
<p>(a) For the function $<span class="math notranslate nohighlight">\(f(x,y)=x^2 y+y^2\)</span><span class="math notranslate nohighlight">\(, calculate \)</span><span class="math notranslate nohighlight">\(\frac{\partial f}{\partial u}\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(\frac{\partial f}{\partial v}\)</span><span class="math notranslate nohighlight">\(, where \)</span><span class="math notranslate nohighlight">\(x=u+v\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(y=u-v\)</span>$.</p>
<p>(b) Calculate $<span class="math notranslate nohighlight">\(\frac{\partial f}{\partial x}\)</span><span class="math notranslate nohighlight">\( for the function \)</span><span class="math notranslate nohighlight">\(f(x,y)=\sin(x^2+2xy)+(x-y)^2\)</span>$</p>
<p>Solution</p>
<p>(a)</p>
<div class="math notranslate nohighlight">
\[f_x = 2xy, \quad f_y = x^2+2y\]</div>
<div class="math notranslate nohighlight">
\[x_u=1, \quad x_v=1, \quad y_u=1, \quad y_v=-1\]</div>
<div class="math notranslate nohighlight">
\[f_u = f_x x_u + y_y y_u = 2xy+(x^2+2y) = 2(u+v)(u-v)+(u+v)^2+2(u-v)\]</div>
<div class="math notranslate nohighlight">
\[f_v = f_x x_v + f_y y_v = 2xy-(x^2+2y) = 2(u+v)(u-v)-(u+v)^2-2(u-v)\]</div>
<p>(b)</p>
<p>We can let $<span class="math notranslate nohighlight">\(u=x^2+2xy\)</span><span class="math notranslate nohighlight">\(, \)</span><span class="math notranslate nohighlight">\(v=x-y\)</span>$, then,</p>
<div class="math notranslate nohighlight">
\[f_x = f_u u_x +f_v v_x =\cos(u)(2x+2y)+2v = 2(x+u)\cos(x^2+2xy)+2(x-y)\]</div>
<p>Exact derivatives/exact differentials
The multivariate chain rule is sometimes written in “differential form”</p>
<p>\begin{equation}\mathrm{d}F=\frac{\partial F}{\partial x}\mathrm{d}x+\frac{\partial F}{\partial y}\mathrm{d}y.\end{equation}</p>
<p>Comparing this result to a general expression of the form</p>
<p>\begin{equation}\mathrm{d}F=A(x,y)\mathrm{d}x+B(x,y)\mathrm{d}y\end{equation}</p>
<p>tells us that $<span class="math notranslate nohighlight">\(A = \frac{\partial F}{\partial x}\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(B=\frac{\partial F}{\partial y}\)</span>$.</p>
<p>For these two results to be consistent, we require that the mixed second derivatives of $<span class="math notranslate nohighlight">\(F\)</span>$ are equal, in accordance with Schwarz’ theorem. Therefore, we require that</p>
<p>\begin{equation}\frac{\partial A}{\partial y}\equiv\frac{\partial B}{\partial x}.\end{equation}</p>
<p>If the differential is exact, then it can be exactly integrated to obtain a solution $<span class="math notranslate nohighlight">\(F\)</span><span class="math notranslate nohighlight">\(. You will not be asked to obtain solutions for \)</span><span class="math notranslate nohighlight">\(F\)</span>$, but you will be asked to verify if a differential expression is exact by testing the condition given above.</p>
<p>Example 4:</p>
<p>Show that ((y\cos{x}+\sin{y}+y)\mathrm{d}x + (\sin{x}+x\cos{y}+x)\mathrm{d}y) is an exact differential.</p>
<p>Solution:</p>
<p>The expression is of the form (A(x,y)\mathrm{d}x+B(x,y)\mathrm{d}y=0) where</p>
<p>(A=y\cos{x}+\sin{y}+y)</p>
<p>(B=\sin{x}+x\cos{y}+x)</p>
<p>Then, (\frac{\partial A}{\partial y} = \cos{x}+\cos{y}+1 = \frac{\partial B}{\partial x}) and so the expression is exact.</p>
<p>Optional: The result could be used to solve the nonlinear 1st order ODE</p>
<p>(\frac{\mathrm{d}y}{\mathrm{d}x} + \frac{y\cos{x}+\sin{y}+y}{\sin{x}+x\cos{y}+x}=0)</p>
<p>Let (A=\frac{\partial F}{\partial x},\ B=\frac{\partial F}{\partial y}) where (F(x,y)) is to be determined.</p>
<p>By integrating (A) w.r.t. (x) and (B) w.r.t (y) we obtain</p>
<p>(F=y\sin{x}+x\sin{y}+xy+F_1(y))</p>
<p>(F=y\sin{x}+x\sin{y}+xy+F_2(x))</p>
<p>where we introduced the arbitrary functions (F_1,\ F_2)</p>
<p>For consistency we require that (F_1(y) = F_2(x) = \mathrm{const.}) This allows us to write the given ODE as</p>
<p>(\frac{\mathrm{d}}{\mathrm{d}x}\left(y\sin{x}+x\sin{y}+xy\right)=0)</p>
<p>The solution is</p>
<p>(y\sin{x}+x\sin{y}+xy=\mathrm{const.})</p>
<p>That is, (F(x,y)=0) where (F(x,y)=y\sin{x}+x\sin{y}+xy+k) and (k) is an arbitrary constant.</p>
<p>Questions for you to try</p>
<ol class="simple">
<li><p>Show that $<span class="math notranslate nohighlight">\(\frac{\partial^2 f}{\partial y \partial x} = \frac{\partial^2 f}{\partial x \partial y}\)</span>$ for the following functions:</p></li>
</ol>
<p>(a) $<span class="math notranslate nohighlight">\(f(x,y) = x^2-xy+y^2\)</span>$</p>
<p>(b) $<span class="math notranslate nohighlight">\(f(x,y)=x(y-x)\sin(x)\)</span>$</p>
<ol class="simple">
<li><p>Given that $<span class="math notranslate nohighlight">\(f(x,y)=\sin(x^2+2xy)+(x-y)^2\)</span><span class="math notranslate nohighlight">\(, calculate \)</span><span class="math notranslate nohighlight">\(\frac{\partial f}{\partial x}\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(\frac{\mathrm{d} f}{\mathrm{d}x}\)</span>$</p></li>
<li><p>Given that $<span class="math notranslate nohighlight">\(F=x^2\sin(y)\)</span><span class="math notranslate nohighlight">\(, calculate \)</span><span class="math notranslate nohighlight">\(\frac{\mathrm{d}F}{\mathrm{d}x}\)</span>$, giving your answer in the form \begin{equation}\frac{\mathrm{d}F}{\mathrm{d}x} = A(x,y)+B(x,y)\frac{\mathrm{d}y}{\mathrm{d}x}\end{equation}</p></li>
</ol>
<p>and verify that $<span class="math notranslate nohighlight">\(\frac{\partial A}{\partial y}=\frac{\partial B}{\partial x}\)</span>$.</p>
<ol class="simple">
<li><p>Given a general differential $<span class="math notranslate nohighlight">\(\mathrm{d}f=A(x,y)\mathrm{d}x+B(x,y)\mathrm{d}y,\)</span><span class="math notranslate nohighlight">\( state the condition for \)</span><span class="math notranslate nohighlight">\(\mathrm{d}f\)</span>$ to be exact. Hence, determine whether the following are exact differentials:</p></li>
</ol>
<p>(a) $<span class="math notranslate nohighlight">\(\mathrm{d}f=\frac{x}{x^2+y^2}\mathrm{d}y-\frac{y}{x^2+y^2}\mathrm{d}x\)</span>$</p>
<p>(b) $<span class="math notranslate nohighlight">\(\mathrm{d}f = y(1+x-x^2)\mathrm{d}x+x(x+1)\mathrm{d}y\)</span>$</p>
<p>(c) $<span class="math notranslate nohighlight">\(2x\sin(y)\mathrm{d}x+x^3\cos(y)\mathrm{d}y\)</span>$</p>
<p>Harder questions:</p>
<ol class="simple">
<li><p>Show that the product and quotient rules can be deduced from the multivariate chain rule.</p></li>
<li><p>If $<span class="math notranslate nohighlight">\(V= x f\left(\frac{y}{x}\right)\)</span>$, show that</p></li>
</ol>
<p>\begin{equation}x^2\frac{\partial^2 V}{\partial x^2}+2xy\frac{\partial^2 V}{\partial x \partial y}+y^2\frac{\partial^2 V}{\partial y^2}=0\end{equation}</p>
<ol class="simple">
<li><p>Assume that $<span class="math notranslate nohighlight">\(\xi=\xi(x,y)\)</span><span class="math notranslate nohighlight">\( where \)</span><span class="math notranslate nohighlight">\(x\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(y\)</span><span class="math notranslate nohighlight">\( are given in plane polar coordinates \)</span><span class="math notranslate nohighlight">\((r,\theta)\)</span>$ so that</p></li>
</ol>
<div class="math notranslate nohighlight">
\[x=r\cos(\theta),\quad y=r\sin(\theta).\]</div>
<p>(a) Calculate $<span class="math notranslate nohighlight">\(\xi_r\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(xi_{\theta}\)</span><span class="math notranslate nohighlight">\( in terms of \)</span><span class="math notranslate nohighlight">\(\xi_x\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(\xi_y\)</span>$, where a subscript denotes partial differentiatio with respect to the subscripted variable. Hence, show that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left(\begin{array}{c}\xi_r\\\xi_{\theta}\end{array}\right)=J(r,\theta)\left(\begin{array}{c}\xi_x\\\xi_y\end{array}\right), \quad \text{where}\quad J(r,\theta)=\left(\begin{array}{cc}\cos(\theta)&amp;\sin(\theta)\\-r\sin(\theta)&amp;r\cos(\theta)\end{array}\right)\end{split}\]</div>
<p>(b) Calculate the inverse of the matrix $<span class="math notranslate nohighlight">\(J(r\theta)\)</span>$ given in part (a) and deduce the results below:</p>
<p>\begin{align}\xi_x&amp;=\cos(\theta)\xi_r - \frac{\sin(\theta)}{r}\xi_{\theta}\xi_y&amp;=\sin(\theta)\xi_r+\frac{\cos(\theta)}{r}\xi_{\theta}\end{align}</p>
<p>(c) Use the relationships given below to calculate the first partial derivatives of $<span class="math notranslate nohighlight">\(r\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(\theta\)</span><span class="math notranslate nohighlight">\( with respect to \)</span><span class="math notranslate nohighlight">\(x\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(y\)</span><span class="math notranslate nohighlight">\( and hence calculate \)</span><span class="math notranslate nohighlight">\(\xi_x\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(\xi_y\)</span><span class="math notranslate nohighlight">\( in terms of \)</span><span class="math notranslate nohighlight">\(\xi_r\)</span><span class="math notranslate nohighlight">\( and \)</span><span class="math notranslate nohighlight">\(\xi_{\theta}\)</span>$</p>
<p>\begin{align}r^2&amp;=x^2+y^2\tan(\theta)&amp;=\frac{y}{x}\end{align}</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">Welcome to NSCI0027</a>
    <a class='right-next' id="next-link" href="integrationprelim.html" title="next page"></a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Peter Bratby, Ella Metcalfe and Peter Bratby<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>